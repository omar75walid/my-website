<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ØªØ­Ø¯ÙŠØ¯ Ù…ÙƒØ§Ù† Ø§Ù„Ø£Ù„Ù… - Ø¨Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</title>
  <link rel="stylesheet" href="style.css">
  <style>
    #camera-box {
      position: relative;
      width: 100%;
      max-width: 500px;
      margin: 20px auto;
    }
    video {
      width: 100%;
      border: 3px dashed #f00;
      border-radius: 10px;
    }
    #marker {
      position: absolute;
      width: 30px;
      height: 30px;
      background-color: red;
      border-radius: 50%;
      display: none;
      z-index: 2;
      opacity: 0.7;
    }
  </style>
</head>
<body>
  <h1>ğŸ“¸ Ø­Ø¯Ø¯ Ù…ÙƒØ§Ù† Ø§Ù„Ø£Ù„Ù… Ø¹Ù„Ù‰ Ø¬Ø³Ù…Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ</h1>

  <div id="camera-box">
    <video id="video" autoplay></video>
    <div id="marker"></div>
  </div>

  <input type="text" id="symptom" placeholder="Ù…Ø«Ø§Ù„: Ø£Ù†Ø§ Ø¹Ù†Ø¯ÙŠ ØµØ¯Ø§Ø¹" style="width: 80%; padding: 10px;">
  <button onclick="markPain()">ğŸ“ Ø­Ø¯Ø¯ Ø§Ù„Ø£Ù„Ù…</button>

  <button onclick="location.href='home.html'">ğŸ  Ø±Ø¬ÙˆØ¹</button>
  <button onclick="toggleMode()">ğŸŒ“ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</button>

  <script>
    const video = document.getElementById("video");
    const marker = document.getElementById("marker");

    const locations = {
      "Ø±Ø£Ø³": { top: "10%", left: "45%" },
      "ØµØ¯Ø§Ø¹": { top: "10%", left: "45%" },
      "Ø±Ù‚Ø¨Ø©": { top: "25%", left: "48%" },
      "ÙƒØªÙ": { top: "30%", left: "30%" },
      "Ù‚Ù„Ø¨": { top: "40%", left: "44%" },
      "ØµØ¯Ø±": { top: "42%", left: "50%" },
      "Ø¨Ø·Ù†": { top: "60%", left: "48%" },
      "Ù…Ø¹Ø¯Ø©": { top: "62%", left: "48%" },
      "Ø¸Ù‡Ø±": { top: "50%", left: "30%" },
      "Ø±Ø¬Ù„": { top: "85%", left: "50%" },
      "Ø±ÙƒØ¨Ø©": { top: "90%", left: "50%" },
      "Ø¹ÙŠÙ†": { top: "12%", left: "48%" }
    };

    function markPain() {
      const text = document.getElementById("symptom").value;
      let matched = false;

      for (const word in locations) {
        if (text.includes(word)) {
          const pos = locations[word];
          marker.style.top = pos.top;
          marker.style.left = pos.left;
          marker.style.display = "block";
          matched = true;
          speak("ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ù„Ù… ÙÙŠ " + word);
          break;
        }
      }

      if (!matched) {
        marker.style.display = "none";
        alert("âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ§Ù†.");
        speak("Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ù…ÙƒØ§Ù† Ø§Ù„Ø£Ù„Ù….");
      }
    }

    function speak(text) {
      const u = new SpeechSynthesisUtterance(text);
      u.lang = "ar-EG";
      speechSynthesis.speak(u);
    }

    function toggleMode() {
      document.body.classList.toggle("dark-mode");
    }

    // ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => video.srcObject = stream)
      .catch(err => {
        alert("âš ï¸ Ù„Ù… ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§");
        console.error(err);
      });
  </script>
</body>
</html>
